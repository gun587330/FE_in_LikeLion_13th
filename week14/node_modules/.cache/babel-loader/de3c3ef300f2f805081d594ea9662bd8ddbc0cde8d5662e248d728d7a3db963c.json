{"ast":null,"code":"//authAxios.js\n\nimport axios from \"axios\";\nimport { getNewRefreshToken } from \"./user\";\nexport const getAuthAxios = token => {\n  console.log(\"getAuthAxios 체크용1\");\n  const authAxios = axios.create({\n    baseURL: \"https://likelion-cau.r-e.kr\",\n    headers: {\n      Authorization: `Bearer ${token}`\n    }\n  });\n  console.log(\"getAuthAxios 체크용2\");\n  authAxios.interceptors.response.use(response => response.data,\n  // 응답이 잘 왔으면 받은 응답을 반환\n\n  async error => {\n    console.log(\"getAuthAxios 체크용3\");\n    try {\n      console.log(\"췍췍\");\n      // 1. refresh로 새 access token 발급 (에러가 발생했을 때 아래 코드들을 실행 > 과제1추가 비동기 await 빠져있음)\n      const result = await getNewRefreshToken();\n      console.log(\"getAuthAxios 체크용4\");\n      error.config.headers.Authorization = result.accessToken;\n      // 오류가 발생한 요청을 했을 때, 헤더에 담아서 보낸 토큰을 새 토큰으로 변경\n      localStorage.setItem(\"accessToken\", result.accessToken);\n      localStorage.setItem(\"refreshToken\", result.refreshToken);\n      return (await axios.get(error.config.url, error.config)).data;\n      //에러가 발생한 요청의 url을 그대로 가져와서 사용하고, 필요한 데이터들은\n      //error.config 객체 내에 담겨있기 때문에 그대로 다시 가져와서 get 요청\n    } catch (refreshError) {\n      console.log(\"리프레시 에러 확인용\");\n      throw refreshError;\n    }\n  });\n  console.log(\"getAuthAxios 체크용5\");\n  return authAxios;\n};","map":{"version":3,"names":["axios","getNewRefreshToken","getAuthAxios","token","console","log","authAxios","create","baseURL","headers","Authorization","interceptors","response","use","data","error","result","config","accessToken","localStorage","setItem","refreshToken","get","url","refreshError"],"sources":["/Users/jeong-geon/Desktop/FrontEnd_Study/Likelion13th-git/week14/src/apis/authAxios.js"],"sourcesContent":["//authAxios.js\n\nimport axios from \"axios\";\nimport { getNewRefreshToken } from \"./user\";\n\nexport const getAuthAxios = (token) => {\n    console.log(\"getAuthAxios 체크용1\");\n  const authAxios = axios.create({\n    baseURL: \"https://likelion-cau.r-e.kr\",\n    headers: {\n      Authorization: `Bearer ${token}`,\n    },\n  });\n    console.log(\"getAuthAxios 체크용2\");\n  authAxios.interceptors.response.use(\n    (response) => response.data, // 응답이 잘 왔으면 받은 응답을 반환\n    \n    async (error) => {\n        console.log(\"getAuthAxios 체크용3\");\n        try{\n            console.log(\"췍췍\");\n            // 1. refresh로 새 access token 발급 (에러가 발생했을 때 아래 코드들을 실행 > 과제1추가 비동기 await 빠져있음)\n            const result = await getNewRefreshToken();\n            console.log(\"getAuthAxios 체크용4\");\n            error.config.headers.Authorization = result.accessToken;\n            // 오류가 발생한 요청을 했을 때, 헤더에 담아서 보낸 토큰을 새 토큰으로 변경\n            localStorage.setItem(\"accessToken\", result.accessToken);\n            localStorage.setItem(\"refreshToken\", result.refreshToken);\n            return (await axios.get(error.config.url, error.config)).data;\n            //에러가 발생한 요청의 url을 그대로 가져와서 사용하고, 필요한 데이터들은\n            //error.config 객체 내에 담겨있기 때문에 그대로 다시 가져와서 get 요청\n            \n        } catch (refreshError){\n            console.log(\"리프레시 에러 확인용\");\n            throw refreshError;\n        }\n    }    \n);\nconsole.log(\"getAuthAxios 체크용5\");\n\n  return authAxios;\n};\n"],"mappings":"AAAA;;AAEA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,kBAAkB,QAAQ,QAAQ;AAE3C,OAAO,MAAMC,YAAY,GAAIC,KAAK,IAAK;EACnCC,OAAO,CAACC,GAAG,CAAC,mBAAmB,CAAC;EAClC,MAAMC,SAAS,GAAGN,KAAK,CAACO,MAAM,CAAC;IAC7BC,OAAO,EAAE,6BAA6B;IACtCC,OAAO,EAAE;MACPC,aAAa,EAAE,UAAUP,KAAK;IAChC;EACF,CAAC,CAAC;EACAC,OAAO,CAACC,GAAG,CAAC,mBAAmB,CAAC;EAClCC,SAAS,CAACK,YAAY,CAACC,QAAQ,CAACC,GAAG,CAChCD,QAAQ,IAAKA,QAAQ,CAACE,IAAI;EAAE;;EAE7B,MAAOC,KAAK,IAAK;IACbX,OAAO,CAACC,GAAG,CAAC,mBAAmB,CAAC;IAChC,IAAG;MACCD,OAAO,CAACC,GAAG,CAAC,IAAI,CAAC;MACjB;MACA,MAAMW,MAAM,GAAG,MAAMf,kBAAkB,CAAC,CAAC;MACzCG,OAAO,CAACC,GAAG,CAAC,mBAAmB,CAAC;MAChCU,KAAK,CAACE,MAAM,CAACR,OAAO,CAACC,aAAa,GAAGM,MAAM,CAACE,WAAW;MACvD;MACAC,YAAY,CAACC,OAAO,CAAC,aAAa,EAAEJ,MAAM,CAACE,WAAW,CAAC;MACvDC,YAAY,CAACC,OAAO,CAAC,cAAc,EAAEJ,MAAM,CAACK,YAAY,CAAC;MACzD,OAAO,CAAC,MAAMrB,KAAK,CAACsB,GAAG,CAACP,KAAK,CAACE,MAAM,CAACM,GAAG,EAAER,KAAK,CAACE,MAAM,CAAC,EAAEH,IAAI;MAC7D;MACA;IAEJ,CAAC,CAAC,OAAOU,YAAY,EAAC;MAClBpB,OAAO,CAACC,GAAG,CAAC,aAAa,CAAC;MAC1B,MAAMmB,YAAY;IACtB;EACJ,CACJ,CAAC;EACDpB,OAAO,CAACC,GAAG,CAAC,mBAAmB,CAAC;EAE9B,OAAOC,SAAS;AAClB,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}