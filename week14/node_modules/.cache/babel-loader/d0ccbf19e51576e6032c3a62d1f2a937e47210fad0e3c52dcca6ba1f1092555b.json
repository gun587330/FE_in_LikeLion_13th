{"ast":null,"code":"import axios from \"axios\";\nimport { getAuthAxios } from \"./authAxios\";\nimport { useNavigate } from \"react-router-dom\";\nconst baseURL = `https://likelion-cau.r-e.kr`;\n\n//export를 해야 함수 내에서도 컴포넌트를 불러올 수 있다\nexport const signup = async (id, pw, name, age) => {\n  const result = await axios.post(`${baseURL}/accounts/signup/`, {\n    id,\n    pw,\n    name,\n    age\n  });\n  return result;\n};\nexport const login = async (id, pw) => {\n  const result = await axios.post(`${baseURL}/accounts/login/`, {\n    id,\n    pw\n  });\n  //data는 axios 내 형식\n  return result.data;\n};\n\n//export const getMyPage = async (token) => {\n//    try{\n//        const response = await axios.post(`${baseURL}/account/mypage`,{\n//            header: {\n//                Authorization: `Bearer ${token}`,\n//            },\n//        });\n//            return response.data;\n//    }\n//    catch (error){\n//        if(error.response?.status === 401){\n//            try{\n//                // 1. 새 토큰 발급 시도\n//                const newTokens = await getNewRefreshToken();\n\n//                // 2. 로컬 스토리지 업데이트\n//                localStorage.setItem(\"access\", newTokens.accessToken);\n//                localStorage.setItem(\"refresh\", newTokens.refreshToken);\n\n//                // 3. 새 토큰으로 재요청\n//                const retryResponse = await axios.get(`${baseURL}/accounts/mypage`,{\n//                    headers: {\n//                        Authorization: `Bearer ${newTokens.accessToken}`,\n//                    },\n//                });\n//                return retryResponse.data;\n//            } catch (refreshError) {\n//                alert(\"토큰이 만료되었습니다. 다시 로그인 해주세요\");\n//                throw refreshError;\n//            }\n//        }else{\n//            throw error;\n//        }\n//    }\n//};\n\n// 과제1) 토큰을 임시로 만료기간을 짧게 설정할 경우 여기서 에러가 발생함 > 예외처리\nexport const getMyPage = async token => {\n  // 과제1) token이 잘못되었을 경우 다시 로그인 페이지로 갈 수 있도록 try-catch 구문\n  try {\n    const authAxios = getAuthAxios(token);\n    const result = await authAxios.get(\"/accounts/mypage\");\n    return result;\n  } catch (error) {\n    throw error;\n  }\n};\nexport const getNewRefreshToken = async () => {\n  try {\n    const accessToken = localStorage.getItem(\"access\");\n    const refreshToken = localStorage.getItem(\"refresh\");\n    const result = await axios.post(`${baseURL}/accounts/refresh`, {\n      refreshToken\n    }, {\n      headers: {\n        Authorization: `Bearer ${accessToken}`\n      }\n    });\n    return result.data;\n  } catch (error) {\n    alert(\"토큰이 만료되었습니다. 다시 로그인 해주세요.\");\n  }\n};","map":{"version":3,"names":["axios","getAuthAxios","useNavigate","baseURL","signup","id","pw","name","age","result","post","login","data","getMyPage","token","authAxios","get","error","getNewRefreshToken","accessToken","localStorage","getItem","refreshToken","headers","Authorization","alert"],"sources":["/Users/jeong-geon/Desktop/FrontEnd_Study/Likelion13th-git/week14/src/apis/user.js"],"sourcesContent":["import axios from \"axios\";\nimport { getAuthAxios } from \"./authAxios\";\nimport { useNavigate } from \"react-router-dom\";\n\nconst baseURL = `https://likelion-cau.r-e.kr`;\n\n//export를 해야 함수 내에서도 컴포넌트를 불러올 수 있다\nexport const signup = async (id, pw, name, age) => {\n    const result = await axios.post(`${baseURL}/accounts/signup/`, {\n        id,\n        pw,\n        name,\n        age,\n    });\n    return result;\n};\n\nexport const login = async (id, pw) => {\n    const result = await axios.post(`${baseURL}/accounts/login/`, {\n        id,\n        pw,\n    });\n    //data는 axios 내 형식\n    return result.data;\n};\n\n//export const getMyPage = async (token) => {\n//    try{\n//        const response = await axios.post(`${baseURL}/account/mypage`,{\n//            header: {\n//                Authorization: `Bearer ${token}`,\n//            },\n//        });\n//            return response.data;\n//    }\n//    catch (error){\n//        if(error.response?.status === 401){\n//            try{\n//                // 1. 새 토큰 발급 시도\n//                const newTokens = await getNewRefreshToken();\n\n//                // 2. 로컬 스토리지 업데이트\n//                localStorage.setItem(\"access\", newTokens.accessToken);\n//                localStorage.setItem(\"refresh\", newTokens.refreshToken);\n\n//                // 3. 새 토큰으로 재요청\n//                const retryResponse = await axios.get(`${baseURL}/accounts/mypage`,{\n//                    headers: {\n//                        Authorization: `Bearer ${newTokens.accessToken}`,\n//                    },\n//                });\n//                return retryResponse.data;\n//            } catch (refreshError) {\n//                alert(\"토큰이 만료되었습니다. 다시 로그인 해주세요\");\n//                throw refreshError;\n//            }\n//        }else{\n//            throw error;\n//        }\n//    }\n//};\n\n\n// 과제1) 토큰을 임시로 만료기간을 짧게 설정할 경우 여기서 에러가 발생함 > 예외처리\nexport const getMyPage = async (token) => {\n    // 과제1) token이 잘못되었을 경우 다시 로그인 페이지로 갈 수 있도록 try-catch 구문\n    try {\n        const authAxios = getAuthAxios(token);\n        const result = await authAxios.get(\"/accounts/mypage\");\n        return result;\n    } catch (error){\n        throw error;\n    }\n\n};\n\n\nexport const getNewRefreshToken = async () => {\n    try {\n        const accessToken = localStorage.getItem(\"access\");\n        const refreshToken = localStorage.getItem(\"refresh\");\n\n        const result = await axios.post(\n            `${baseURL}/accounts/refresh`,\n            {\n                refreshToken,\n            },\n            {\n                headers: {\n                    Authorization: `Bearer ${accessToken}`,\n                },\n            }\n        )\n            return result.data;\n    } catch (error) {\n        alert(\"토큰이 만료되었습니다. 다시 로그인 해주세요.\");\n    }\n}\n"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,YAAY,QAAQ,aAAa;AAC1C,SAASC,WAAW,QAAQ,kBAAkB;AAE9C,MAAMC,OAAO,GAAG,6BAA6B;;AAE7C;AACA,OAAO,MAAMC,MAAM,GAAG,MAAAA,CAAOC,EAAE,EAAEC,EAAE,EAAEC,IAAI,EAAEC,GAAG,KAAK;EAC/C,MAAMC,MAAM,GAAG,MAAMT,KAAK,CAACU,IAAI,CAAC,GAAGP,OAAO,mBAAmB,EAAE;IAC3DE,EAAE;IACFC,EAAE;IACFC,IAAI;IACJC;EACJ,CAAC,CAAC;EACF,OAAOC,MAAM;AACjB,CAAC;AAED,OAAO,MAAME,KAAK,GAAG,MAAAA,CAAON,EAAE,EAAEC,EAAE,KAAK;EACnC,MAAMG,MAAM,GAAG,MAAMT,KAAK,CAACU,IAAI,CAAC,GAAGP,OAAO,kBAAkB,EAAE;IAC1DE,EAAE;IACFC;EACJ,CAAC,CAAC;EACF;EACA,OAAOG,MAAM,CAACG,IAAI;AACtB,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA;AACA,OAAO,MAAMC,SAAS,GAAG,MAAOC,KAAK,IAAK;EACtC;EACA,IAAI;IACA,MAAMC,SAAS,GAAGd,YAAY,CAACa,KAAK,CAAC;IACrC,MAAML,MAAM,GAAG,MAAMM,SAAS,CAACC,GAAG,CAAC,kBAAkB,CAAC;IACtD,OAAOP,MAAM;EACjB,CAAC,CAAC,OAAOQ,KAAK,EAAC;IACX,MAAMA,KAAK;EACf;AAEJ,CAAC;AAGD,OAAO,MAAMC,kBAAkB,GAAG,MAAAA,CAAA,KAAY;EAC1C,IAAI;IACA,MAAMC,WAAW,GAAGC,YAAY,CAACC,OAAO,CAAC,QAAQ,CAAC;IAClD,MAAMC,YAAY,GAAGF,YAAY,CAACC,OAAO,CAAC,SAAS,CAAC;IAEpD,MAAMZ,MAAM,GAAG,MAAMT,KAAK,CAACU,IAAI,CAC3B,GAAGP,OAAO,mBAAmB,EAC7B;MACImB;IACJ,CAAC,EACD;MACIC,OAAO,EAAE;QACLC,aAAa,EAAE,UAAUL,WAAW;MACxC;IACJ,CACJ,CAAC;IACG,OAAOV,MAAM,CAACG,IAAI;EAC1B,CAAC,CAAC,OAAOK,KAAK,EAAE;IACZQ,KAAK,CAAC,2BAA2B,CAAC;EACtC;AACJ,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}